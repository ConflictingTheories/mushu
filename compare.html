<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>yo.js ‚Äî Code Comparison</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace;
      background: #0d1117;
      color: #c9d1d9;
      min-height: 100vh;
    }
    header {
      background: linear-gradient(135deg, #161b22 0%, #21262d 100%);
      padding: 2rem;
      border-bottom: 1px solid #30363d;
    }
    h1 {
      font-size: 2rem;
      background: linear-gradient(90deg, #58a6ff, #a371f7);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.5rem;
    }
    .subtitle { color: #8b949e; font-size: 1.1rem; }
    .stats-bar {
      display: flex;
      gap: 2rem;
      margin-top: 1.5rem;
      flex-wrap: wrap;
    }
    .stat {
      background: #21262d;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      border: 1px solid #30363d;
    }
    .stat-value {
      font-size: 2rem;
      font-weight: bold;
      color: #58a6ff;
    }
    .stat-value.green { color: #3fb950; }
    .stat-value.purple { color: #a371f7; }
    .stat-label { color: #8b949e; font-size: 0.85rem; margin-top: 0.25rem; }
    
    .comparison-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
      margin: 2rem;
    }
    .code-panel {
      background: #161b22;
      border: 1px solid #30363d;
      overflow: hidden;
    }
    .code-panel:first-child { border-radius: 8px 0 0 8px; border-right: none; }
    .code-panel:last-child { border-radius: 0 8px 8px 0; }
    .panel-header {
      background: #21262d;
      padding: 0.75rem 1rem;
      border-bottom: 1px solid #30363d;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .panel-title { font-weight: 600; }
    .panel-title.before { color: #f85149; }
    .panel-title.after { color: #3fb950; }
    .line-count {
      font-size: 0.85rem;
      background: #30363d;
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
    }
    .line-count.reduced {
      background: #238636;
      color: #fff;
    }
    pre {
      padding: 1rem;
      overflow-x: auto;
      font-size: 0.8rem;
      line-height: 1.5;
      max-height: 600px;
      overflow-y: auto;
    }
    code {
      font-family: inherit;
    }
    
    /* Syntax highlighting */
    .keyword { color: #ff7b72; }
    .string { color: #a5d6ff; }
    .number { color: #79c0ff; }
    .comment { color: #8b949e; font-style: italic; }
    .function { color: #d2a8ff; }
    .type { color: #7ee787; }
    
    .demo-links {
      margin: 2rem;
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    .demo-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: linear-gradient(135deg, #238636, #2ea043);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .demo-link:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(46, 160, 67, 0.4);
    }
    .demo-link.original {
      background: linear-gradient(135deg, #6e7681, #484f58);
    }
    
    nav {
      margin: 2rem;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    nav a {
      padding: 0.5rem 1rem;
      background: #21262d;
      color: #58a6ff;
      text-decoration: none;
      border-radius: 6px;
      border: 1px solid #30363d;
      transition: background 0.2s;
    }
    nav a:hover { background: #30363d; }
    nav a.active { background: #58a6ff; color: #0d1117; border-color: #58a6ff; }
    
    .philosophy {
      margin: 2rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
      border: 1px solid #30363d;
      border-radius: 8px;
      border-left: 4px solid #a371f7;
    }
    .philosophy h3 { color: #a371f7; margin-bottom: 0.75rem; }
    .philosophy p { color: #9ca3af; line-height: 1.6; }
    .philosophy code { background: #30363d; padding: 0.2rem 0.4rem; border-radius: 4px; color: #7ee787; }
  </style>
</head>
<body>

<header>
  <h1>yo.js ‚Äî The Hookable Fluent Pattern</h1>
  <p class="subtitle">Simple by default, powerful when you need it</p>
  
  <div class="stats-bar">
    <div class="stat">
      <div class="stat-value">~190</div>
      <div class="stat-label">Lines Before (webgl.html)</div>
    </div>
    <div class="stat">
      <div class="stat-value green">~40</div>
      <div class="stat-label">Lines After (yo-plasma.html)</div>
    </div>
    <div class="stat">
      <div class="stat-value purple">79%</div>
      <div class="stat-label">Code Reduction</div>
    </div>
  </div>
</header>

<nav>
  <a href="#plasma" class="active">Plasma (WebGL)</a>
  <a href="#fire">Fire (WebGL)</a>
  <a href="#water">Water (WebGL)</a>
  <a href="#gpu-plasma">Plasma (WebGPU)</a>
  <a href="#gpu-fire">Fire (WebGPU)</a>
</nav>

<div class="philosophy">
  <h3>ü™ù The Hookable Fluent Pattern</h3>
  <p>
    Traditional APIs force you to learn everything upfront. yo.js flips this: 
    <strong>start with defaults, hook when needed</strong>. 
    Call <code>yo(canvas).use(shader(`...`)).go()</code> and you have a working shader. 
    Need mouse interaction? Add <code>.use(fps())</code>. 
    Need ping-pong FBOs? Add <code>.use(simulation())</code>. 
    Each hook is chainable, each default is overridable.
  </p>
</div>

<section id="plasma">
  <div class="demo-links">
    <a href="yo-plasma.html" class="demo-link">‚ñ∂ Run yo-plasma.html</a>
    <a href="webgl.html" class="demo-link original">‚ñ∂ Run Original</a>
  </div>
  
  <div class="comparison-grid">
    <div class="code-panel">
      <div class="panel-header">
        <span class="panel-title before">‚ùå webgl.html (Original)</span>
        <span class="line-count">~190 lines</span>
      </div>
      <pre><code><span class="comment">// Must manually:</span>
<span class="comment">// - Create WebGL2 context with fallback</span>
<span class="comment">// - Write vertex shader boilerplate</span>
<span class="comment">// - Compile both shaders with error handling</span>
<span class="comment">// - Create and link program</span>
<span class="comment">// - Create quad geometry (vertices, VAO, VBO)</span>
<span class="comment">// - Set up uniforms (time, resolution, mouse)</span>
<span class="comment">// - Handle resize events</span>
<span class="comment">// - Handle mouse events</span>
<span class="comment">// - Create animation loop</span>
<span class="comment">// - Draw calls</span>

<span class="keyword">const</span> gl = canvas.<span class="function">getContext</span>(<span class="string">'webgl2'</span>);
<span class="keyword">if</span> (!gl) { <span class="comment">/* fallback... */</span> }

<span class="keyword">const</span> vertexShader = <span class="string">`#version 300 es
in vec2 aPos;
void main() {
  gl_Position = vec4(aPos, 0.0, 1.0);
}`</span>;

<span class="comment">// ... 150+ more lines of boilerplate ...</span>

<span class="keyword">function</span> <span class="function">compileShader</span>(src, type) {
  <span class="keyword">const</span> sh = gl.<span class="function">createShader</span>(type);
  gl.<span class="function">shaderSource</span>(sh, src);
  gl.<span class="function">compileShader</span>(sh);
  <span class="keyword">if</span> (!gl.<span class="function">getShaderParameter</span>(sh, gl.COMPILE_STATUS)) {
    <span class="keyword">throw</span> gl.<span class="function">getShaderInfoLog</span>(sh);
  }
  <span class="keyword">return</span> sh;
}

<span class="comment">// ... program linking, VAO setup, uniforms ...</span></code></pre>
    </div>
    
    <div class="code-panel">
      <div class="panel-header">
        <span class="panel-title after">‚úÖ yo-plasma.html (Simplified)</span>
        <span class="line-count reduced">~40 lines</span>
      </div>
      <pre><code><span class="keyword">import</span> { yo, shader, quad, fps } <span class="keyword">from</span> <span class="string">'./yo.js'</span>;

<span class="function">yo</span>(document.<span class="function">getElementById</span>(<span class="string">'c'</span>))
  .<span class="function">use</span>(<span class="function">shader</span>(<span class="string">`
    void mainImage(out vec4 O, vec2 C) {
      vec2 uv = C / resolution;
      float t = time * 0.5;
      
      float v = 0.0;
      v += sin(uv.x * 10.0 + t);
      v += sin((uv.y * 10.0 + t) * 0.5);
      v += sin((uv.x * 10.0 + uv.y * 10.0 + t) * 0.3);
      
      vec2 c = uv + 0.5 * vec2(sin(t*0.2), cos(t*0.3));
      v += sin(sqrt(dot(c,c) + 1.0) * 10.0 + t);
      v *= 0.5;
      
      vec3 col = vec3(
        sin(v * 3.14159) * 0.5 + 0.5,
        sin(v * 3.14159 + 2.094) * 0.5 + 0.5,
        sin(v * 3.14159 + 4.188) * 0.5 + 0.5
      );
      
      O = vec4(col, 1.0);
    }
  `</span>))
  .<span class="function">use</span>(<span class="function">quad</span>())
  .<span class="function">use</span>(<span class="function">fps</span>())
  .<span class="function">go</span>();

<span class="comment">// That's it. WebGL2 context, shaders, uniforms,</span>
<span class="comment">// geometry, resize handling, mouse tracking,</span>
<span class="comment">// animation loop ‚Äî all handled by yo.js</span></code></pre>
    </div>
  </div>
</section>

<section id="fire" style="margin-top: 3rem;">
  <div class="demo-links">
    <a href="yo-fire.html" class="demo-link">‚ñ∂ Run yo-fire.html</a>
    <a href="fire.html" class="demo-link original">‚ñ∂ Run Original</a>
  </div>
  
  <div class="comparison-grid">
    <div class="code-panel">
      <div class="panel-header">
        <span class="panel-title before">‚ùå fire.html (Original)</span>
        <span class="line-count">~350 lines</span>
      </div>
      <pre><code><span class="comment">// Must manually:</span>
<span class="comment">// - Everything from basic WebGL PLUS:</span>
<span class="comment">// - Create 2 framebuffers for ping-pong</span>
<span class="comment">// - Create 2 textures with proper format</span>
<span class="comment">// - Handle FBO completeness checks</span>
<span class="comment">// - Write simulation shader (read from texture)</span>
<span class="comment">// - Write display shader (colorize output)</span>
<span class="comment">// - Swap framebuffers each frame</span>
<span class="comment">// - Bind correct textures to correct units</span>
<span class="comment">// - Manage backbuffer uniform</span>

<span class="comment">// Create ping-pong framebuffers</span>
<span class="keyword">const</span> fbos = [<span class="number">0</span>, <span class="number">1</span>].<span class="function">map</span>(() => {
  <span class="keyword">const</span> fbo = gl.<span class="function">createFramebuffer</span>();
  <span class="keyword">const</span> tex = gl.<span class="function">createTexture</span>();
  gl.<span class="function">bindTexture</span>(gl.TEXTURE_2D, tex);
  gl.<span class="function">texImage2D</span>(gl.TEXTURE_2D, <span class="number">0</span>, gl.RGBA16F,
    w, h, <span class="number">0</span>, gl.RGBA, gl.HALF_FLOAT, <span class="keyword">null</span>);
  gl.<span class="function">texParameteri</span>(<span class="comment">/* ... clamp, filter ... */</span>);
  gl.<span class="function">bindFramebuffer</span>(gl.FRAMEBUFFER, fbo);
  gl.<span class="function">framebufferTexture2D</span>(<span class="comment">/* ... */</span>);
  <span class="keyword">return</span> { fbo, tex };
});

<span class="comment">// In render loop: swap, bind, draw, repeat</span>
<span class="comment">// ... 250+ more lines ...</span></code></pre>
    </div>
    
    <div class="code-panel">
      <div class="panel-header">
        <span class="panel-title after">‚úÖ yo-fire.html (Simplified)</span>
        <span class="line-count reduced">~85 lines</span>
      </div>
      <pre><code><span class="keyword">import</span> { yo, simulation, fps } <span class="keyword">from</span> <span class="string">'./yo.js'</span>;

<span class="keyword">const</span> sim = <span class="function">simulation</span>({ scale: <span class="number">0.5</span> });

sim.<span class="function">simulate</span>(<span class="string">`
  void mainImage(out vec4 O, vec2 C) {
    // Read neighbors, do physics
    vec4 up = sample(vec2(0,1));
    // ... fire simulation logic ...
    O = vec4(fuel, heat, smoke, 1.0);
  }
`</span>);

sim.<span class="function">display</span>(<span class="string">`
  void mainImage(out vec4 O, vec2 C) {
    vec4 data = texture(backbuffer, uv);
    // ... colorize based on heat ...
    O = vec4(fireColor, 1.0);
  }
`</span>);

<span class="function">yo</span>(canvas)
  .<span class="function">use</span>(sim)
  .<span class="function">use</span>(<span class="function">fps</span>())
  .<span class="function">go</span>();

<span class="comment">// simulation() handles:</span>
<span class="comment">// - Framebuffer creation</span>
<span class="comment">// - Texture allocation (RGBA16F)</span>
<span class="comment">// - Ping-pong swapping</span>
<span class="comment">// - backbuffer uniform binding</span>
<span class="comment">// - sample() helper function</span></code></pre>
    </div>
  </div>
</section>

<script>
  // Simple nav highlighting
  document.querySelectorAll('nav a').forEach(link => {
    link.addEventListener('click', e => {
      document.querySelectorAll('nav a').forEach(l => l.classList.remove('active'));
      e.target.classList.add('active');
    });
  });
</script>

</body>
</html>